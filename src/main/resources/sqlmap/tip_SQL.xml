<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.brownie.tip.service.impl.TipMapper">
    <select id="selectTipList" parameterType="hashMap" resultType="kr.co.brownie.tip.service.TipVO">
        <![CDATA[
        SELECT BOARDSEQ,
               BOARDKIND,
               BOARDCATEGORY,
               TITLE,
               CONTENT,
               NOTICEYN,
               STATUS,
               INDATE,
               INUSERID,
               "UPDATE",
               UPUSERID,
               FILESEQ,
               SUBSEQ
        FROM (SELECT BOARD_SEQ      AS BOARDSEQ,
                     BOARD_KIND     AS BOARDKIND,
                     BOARD_CATEGORY AS BOARDCATEGORY,
                     TITLE          AS TITLE,
                     CONTENT        AS CONTENT,
                     NOTICE_YN      AS NOTICEYN,
                     STATUS         AS STATUS,
                     IN_DATE        AS INDATE,
                     IN_USER_ID     AS INUSERID,
                     UP_DATE        AS "UPDATE",
                     UP_USER_ID     AS UPUSERID,
                     FILE_SEQ       AS FILESEQ,
                     SUB_SEQ        AS SUBSEQ
              FROM BROWNIE_BOARD
              WHERE BOARD_KIND = 'tip'
                AND (#{champion} IS NULL OR BOARD_CATEGORY = #{champion})
              ORDER BY BOARD_SEQ DESC
             )
        WHERE ${contentPerPage} * (${currentPageNumber} - 1) < ROWNUM
          AND ROWNUM <= ${contentPerPage} * ${currentPageNumber}
        ]]>
    </select>
    <select id="countTipList" parameterType="String" resultType="int">
        SELECT COUNT(*)
        FROM BROWNIE_BOARD
        WHERE BOARD_KIND = 'tip'
          AND (#{champion} IS NULL OR BOARD_CATEGORY = #{champion})
    </select>
    <select id="select" parameterType="int" resultType="kr.co.brownie.tip.service.TipVO">
        SELECT BOARD_SEQ      AS BOARDSEQ,
               BOARD_KIND     AS BOARDKIND,
               BOARD_CATEGORY AS BOARDCATEGORY,
               TITLE          AS TITLE,
               CONTENT        AS CONTENT,
               NOTICE_YN      AS NOTICEYN,
               STATUS         AS STATUS,
               IN_DATE        AS INDATE,
               IN_USER_ID     AS INUSERID,
               UP_DATE        AS "UPDATE",
               UP_USER_ID     AS UPUSERID,
               FILE_SEQ       AS FILESEQ,
               SUB_SEQ        AS SUBSEQ
        FROM BROWNIE_BOARD
        WHERE BOARD_KIND = 'tip'
          AND BOARD_SEQ = ${board_seq}
    </select>

    <insert id="insert" parameterType="hashMap">
        INSERT INTO BROWNIE_BOARD(BOARD_SEQ,
                                  BOARD_KIND,
                                  BOARD_CATEGORY,
                                  TITLE,
                                  CONTENT,
                                  NOTICE_YN,
                                  STATUS,
                                  IN_DATE,
                                  IN_USER_ID,
                                  UP_DATE,
                                  UP_USER_ID,
                                  FILE_SEQ,
                                  SUB_SEQ)
        VALUES ((SELECT NVL(MAX(BOARD_SEQ), 0) + 1
                 FROM BROWNIE_BOARD),
                'tip',
                #{champion},
                #{title},
                #{content},
                'n',
                '1',
                SYSDATE,
                '${author}',
                SYSDATE,
                '${author}',
                null,
                null)
    </insert>
    <update id="update" parameterType="hashMap">
        UPDATE BROWNIE_BOARD
        SET BOARD_CATEGORY = #{champion},
            TITLE          = #{title},
            CONTENT        = #{content},
            UP_DATE        = SYSDATE,
            UP_USER_ID     = #{author}
        WHERE BOARD_SEQ = #{boardSeq}
    </update>
</mapper>